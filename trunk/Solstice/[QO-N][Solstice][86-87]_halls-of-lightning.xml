<HBProfile creator="Botanist" version="1.0">
	<Name>[QO-N][Solstice][86-87]_halls-of-lightning</Name>
   
	<MinLevel>1</MinLevel>
	<MaxLevel>101</MaxLevel>
   
	<MinDurability>-1</MinDurability>
	<MinFreeBagSlots>-1</MinFreeBagSlots>
	
	<MailGrey>False</MailGrey>
	<MailWhite>False</MailWhite>
	<MailGreen>False</MailGreen>
	<MailBlue>False</MailBlue>
	<MailPurple>False</MailPurple>
   
	<SellGrey>True</SellGrey>
	<SellWhite>True</SellWhite>
	<SellGreen>True</SellGreen>
	<SellBlue>True</SellBlue>
	<SellPurple>False</SellPurple>
   
	<TargetElites>True</TargetElites>
	
	<AvoidMobs>		
		<Mob Name="Summon Enabler Stalker" Entry="53488" />
	</AvoidMobs>
	
	<Blackspots>
	</Blackspots>

	<Mailboxes>
	</Mailboxes>
 
	<Vendors>
	</Vendors>
	
	<ProtectedItems>
	</ProtectedItems>

	<Factions>16</Factions>
	
	<QuestOrder>
		<ClearVendor />
		<ClearMailbox />


		<If Condition="Me.Level &gt;= 86">
			<CustomBehavior File="Message" 
							Text="You meet the level requirement to run this profile." 
							LogColor="Fuchsia" />
		
		 	<!-- Booster UserSettings -->
			<CustomBehavior File="UserSettings"
							AdvancedSettingsMode="True"
							FindMountAutomatically="True"
							FindVendorsAutomatically="False"
							GroundMountFarmingMode="False"
							HarvestHerbs="False"
							HarvestMinerals="False"
							KillBetweenHotspots="True"
							LogoutForInactivity="False"
							LogoutInactivityUseForceQuit="False"
							LootChests="False"
							LootMobs="True"
							LootRadius="1"
							MountDistance="75"
							MountName=""
							NinjaSkin="False"
							ProfileDebuggingMode="False"
							PullDistance="25"
							RessAtSpiritHealers="False"
							SkinMobs="False"
							UseFlightPaths="True"
							UseMount="True" 
							UseRandomMount="False" />
							
			<!-- Infinite loop -->
			<While Condition="true" >	
			
				<!-- Halls of Lightning -->
				<If Condition="Me.ZoneId == 4272">
					<CustomBehavior File="Message" 
									Text="Halls of Lightning detected. Running out."
									LogColor="Fuchsia" />
						
					<!-- Make our way to the exit -->
					<RunTo X="1331.41" Y="241.904" Z="52.5046" />

					<!-- Go through the portal -->
					<CustomBehavior File="Misc\InInstance" X="1333.524" Y="290.7161" Z="52.81057" />
					
					<!-- Make sure we run to the right spot outside the potral -->
					<RunTo X="9175.68" Y="-1378.8" Z="1103.57" />
				</If> <!-- HoL -->
				
				<!-- If we are not in the box, load the movement profile -->
				<If Condition="Me.X &lt; 9100 || Me.X &gt; 9200 || Me.Y &lt; -1400 || Me.Y &gt; -1300" >
					<CustomBehavior File="Message" 
									Text="Distance from portal is not within our proximity, initializing movement to get there."
									LogColor="Fuchsia" />	
									
					<CustomBehavior File="LoadProfile" 
									ProfileName="Movement\[QO-N-M][Solstice][86-87]_halls-of-lightning" />
				</If> <!-- Not in box -->
				
				<!-- If we are in the box -->
				<If Condition="Me.X &gt; 9100 &amp;&amp; Me.X &lt; 9200 &amp;&amp; Me.Y &gt; -1400 &amp;&amp; Me.Y &lt; -1300" >
					<CustomBehavior File="Message" 
									Text="Portal detected nearby."
									LogColor="Fuchsia" />	
					<!-- Resetting the instance -->
					<CustomBehavior File="Message" 
									Text="Resetting the instance." 
									LogColor="Fuchsia" />
					
					<CustomBehavior File="RunMacro" 
									Macro="/script ResetInstances()" />
					<CustomBehavior File="RunMacro"
									Macro="/script SetDungeonDifficulty(1)" />	
						
					<CustomBehavior File="Message" 
									Text="Instance reset." 
									LogColor="Fuchsia" />
									
					<!-- If we didn't enter the instance, wait 20 seconds then attempt to enter again -->
					<While Condition="Me.ZoneId != 4272">
						<!-- Make sure we run to the right spot outside the portal -->
						<RunTo X="9175.68" Y="-1378.8" Z="1103.57" />

						<!-- Run back in the portal -->
						<CustomBehavior File="Misc\InInstance" X="9188.984" Y="-1390.553" Z="1110.215" />
										
						<CustomBehavior File="Message" 
										Text="Waiting for the dungeon to load." 
										LogColor="Fuchsia" />
									
						<CustomBehavior File="WaitTimer" 
										WaitTime="20000"
										VariantTime="20000" />
										
						<!-- If we still aren't in, we're locked out -->
						<If Condition="Me.ZoneId != 4272">
							<CustomBehavior File="Message" 
											Text="We are locked out. Waiting and trying again." 
											LogColor="Fuchsia" />
						</If> <!-- Locked -->
					</While> <!-- While we aren't in the instance -->
				</If> <!-- In box -->
				
				<!-- If we are inside and have checked our reset -->
				<If Condition="Me.ZoneId == 4272">
					<!-- Entrance -->
					<RunTo X="1331.41" Y="241.904" Z="52.5046" />
	
					<!-- Instance timer -->
					<CustomBehavior File="Misc\InstanceTimer" Timer="Start" />
	
					<CustomBehavior File="Message" 
									Text="Halls of Lightning initialized."  
									LogColor="Fuchsia" />
									
					<!-- pull entrance -->
					<RunTo X="1326.498" Y="166.4467" Z="53.70409" />
					<RunTo X="1332.182" Y="99.07405" Z="40.18036" />
					
					<!-- clear the right front platform -->
					<RunTo X="1294.004" Y="92.10909" Z="36.14819" />
					<RunTo X="1270.179" Y="103.6449" Z="33.50556" />
	
					<!-- Line up the proper angle for the General Bjarngrim target macro -->
					<RunTo X="1304.761" Y="100.0253" Z="38.55698" />
					<RunTo X="1295.259" Y="99.64906" Z="36.42612" />
			
					<While Condition="Me.Y &gt; 75" >
					
						<!-- Target General Bjarngrim -->
						<CustomBehavior File="Message" 
												Text="Targeting General Bjarngrim. DO NOT TOUCH !!!" 
												LogColor="Orange" />
												
						<CustomBehavior File="RunMacro" Macro="/targetenemy [noharm]" />
						
						<If Condition="(Me.CurrentTarget != null) &amp;&amp; (Me.CurrentTarget.Entry == 28586)">
						
							<!-- Profile message - My target is General Bjarngrim -->
							<CustomBehavior File="Message" 
												Text="My target is General Bjarngrim." 
												LogColor="Fuchsia" />
												
							<!-- Cast Army of the Dead -->
							<CustomBehavior File="RunMacro" Macro="/cast Army of the Dead" />
								
							  <!-- Wait timer -->
							<CustomBehavior File="WaitTimer" 
												WaitTime="5000" />
												
							  <!-- Forces kill of General Bjarngrim -->
							<CustomBehavior File="GetOutOfGroundEffectAndAuras" 
											EventCompleteWhen="SpecificMobsDead" EventCompleteDeadMobId="28586"
											EventX="1262.115" EventY="99.51503" EventZ="33.50551"
											MoveOutOfGroundEffectAuraId1="111111"
											MoveAwayFromMobCastingSpellId1="111111"
											MoveAwayFromMobWithAuraId1="111111">
								<Safespots>
									<Hotspot X="1262.115" Y="99.51503" Z="33.50551" />
								</Safespots>
							</CustomBehavior>
							
							<!-- Return to the center of the circle -->
							<RunTo X="1261.765" Y="99.22363" Z="33.50551" />
							
							<!-- Move past Y location 75 to break the loop -->
							<CustomBehavior File="MyCTM" X="1262.419" Y="59.93425" Z="33.18529" />
							<Else>
								
								<!-- Profile message - My target is not General Bjarngrim -->
								<CustomBehavior File="Message" 
													Text="My target is not General Bjarngrim." 
													LogColor="Fuchsia" />
							</Else>					
						</If>
						<CustomBehavior File="RunMacro" Macro="/cleartarget" NumOfTimes="1" WaitTime="0"/>
					</While> <!-- Infinite loop -->	
					
					<!-- Pull front right corner to the back right corner -->
					<RunTo X="1254.295" Y="58.20074" Z="33.5056" />
					<RunTo X="1271.316" Y="42.76962" Z="33.50558" />
					<RunTo X="1253.993" Y="23.42127" Z="33.50569" />
					<RunTo X="1270.521" Y="5.903249" Z="33.50577" />
					<RunTo X="1259.842" Y="-32.71298" Z="33.50577" />
											
					<!-- Pull back right corner to the Iron Crucible -->
					<RunTo X="1280.169" Y="-33.99865" Z="33.5058" />
					<RunTo X="1326.478" Y="-33.9321" Z="40.1817" />
					<RunTo X="1336.967" Y="-31.51172" Z="40.1817" />
							
					<!-- Pull the Iron Crucible to the Unyielding Garrison -->	
					<RunTo X="1354.329" Y="5.261074" Z="43.15365" />
					<RunTo X="1363.421" Y="-4.571633" Z="42.99044" />			
					<RunTo X="1365.948" Y="17.78572" Z="48.46579" />
					<RunTo X="1375.217" Y="7.435031" Z="48.22897" />
					<RunTo X="1378.08" Y="18.51252" Z="50.03817" />
					<RunTo X="1395.017" Y="36.47628" Z="50.03823" />						
						
					<!-- Pull the Unyielding Garrison to the first platform and back -->	
					<RunTo X="1376.603" Y="45.38057" Z="50.0383" />
					<RunTo X="1341.149" Y="81.93388" Z="40.17981" />
					<RunTo X="1348.616" Y="89.87563" Z="40.17981" />
					<RunTo X="1355.207" Y="85.64785" Z="40.17981" />
					<RunTo X="1370.422" Y="68.28822" Z="46.5434" />   <!-- top left ramp -->
					<RunTo X="1379.36" Y="51.26277" Z="50.03828" />   <!-- center top of the ramp -->
					<RunTo X="1441.873" Y="28.89459" Z="56.66949" />	<!-- Top right -->
					<RunTo X="1435.227" Y="44.53588" Z="56.66731" />	<!-- left of top platform -->						
					
					<!-- Run to the entrance to The Iron Crucible -->
					<RunTo X="1331.784" Y="-79.95277" Z="28.25682" />
					
					<!-- Runlikehell through the Iron Crucible -->
					<CustomBehavior File="RunLikeHell" 
									NumOfTimes="1" 
									AllowCombat="false">
						<Hotspot X="1332.292" Y="-99.18593" Z="23.22617" />
						<Hotspot X="1344.798" Y="-164.3674" Z="23.22564" />			
						<Hotspot X="1331.64" Y="-219.6317" Z="33.62513" />
					</CustomBehavior>
					<RunTo X="1331.64" Y="-219.6317" Z="33.62513" />	
															
					<!-- Iron Crucible to right before Volkhan -->
					<RunTo X="1332.387" Y="-238.3228" Z="37.82282" />
					<RunTo X="1290.294" Y="-238.3352" Z="37.8051" />
					<RunTo X="1371.666" Y="-238.5405" Z="37.80714" />
					<RunTo X="1353.948" Y="-238.0735" Z="37.80894" />
					<RunTo X="1354.204" Y="-194.9131" Z="52.02685" />
					<RunTo X="1367.762" Y="-177.4445" Z="52.02541" />
					<RunTo X="1358.797" Y="-171.1923" Z="52.02398" />
					<RunTo X="1337.909" Y="-189.5892" Z="52.02398" />
					<RunTo X="1323.371" Y="-192.7129" Z="52.02398" />
					<RunTo X="1309.993" Y="-176.9664" Z="52.02398" />
					<RunTo X="1295.786" Y="-187.218" Z="52.02398" />
					<RunTo X="1319.716" Y="-182.3077" Z="52.02398" />
					<RunTo X="1306.378" Y="-163.5532" Z="52.02269" />
					<RunTo X="1296.794" Y="-134.4696" Z="55.37402" />
					<RunTo X="1308.698" Y="-164.2385" Z="52.02111" />
					<RunTo X="1316.147" Y="-142.6103" Z="52.02751" />
					<RunTo X="1334.379" Y="-139.9993" Z="53.04551" />
					<RunTo X="1349.732" Y="-142.866" Z="52.02883" />
					<RunTo X="1362.115" Y="-161.4371" Z="52.02435" />
					<RunTo X="1367.033" Y="-133.9456" Z="56.06025" />
							
					<!-- Forces kill of Volkhan -->
					<CustomBehavior File="GetOutOfGroundEffectAndAuras" 
									EventCompleteWhen="SpecificMobsDead" EventCompleteDeadMobId="28587"
									EventX="1332.382" EventY="-102.078" EventZ="56.71782"
									MoveOutOfGroundEffectAuraId1="111111"
									MoveAwayFromMobCastingSpellId1="111111"
									MoveAwayFromMobWithAuraId1="111111">
						<Safespots>
							<Hotspot X="1332.382" Y="-102.078" Z="56.71782" />
						</Safespots>
					</CustomBehavior>	
														
					<!-- Volkhan to Ionar -->
					<RunTo X="1323.208" Y="-127.011" Z="56.71666" />
					<RunTo X="1280.654" Y="-163.9714" Z="52.02113" />
					<RunTo X="1183.864" Y="-170.7721" Z="52.15198" />
					<RunTo X="1176.803" Y="-238.1685" Z="52.36646" />
					<RunTo X="1175.815" Y="-262.202" Z="52.3545" />
					<RunTo X="1177.507" Y="-325.2932" Z="52.33775" />
					<RunTo X="1175.874" Y="-261.8661" Z="52.35222" />
					<RunTo X="1109.039" Y="-262.42" Z="56.87386" />
					<RunTo X="1126.785" Y="-306.2316" Z="56.87439" />
					<RunTo X="1126.697" Y="-326.1796" Z="56.87439" />
					<RunTo X="1122.756" Y="-285.4101" Z="56.88467" />
					<RunTo X="1112.092" Y="-262.2586" Z="56.87514" />
					
					<!-- Cast Army of the Dead -->
					<CustomBehavior File="RunMacro" Macro="/cast Army of the Dead" />
								
					 <!-- Wait timer -->
					<CustomBehavior File="WaitTimer" 
										WaitTime="5000" />
												
					<!-- GOOGE to force kill of Ionar -->
					<CustomBehavior File="GetOutOfGroundEffectAndAuras" 
									EventCompleteWhen="SpecificMobsDead" EventCompleteDeadMobId="28546"
									EventX="1080.433" EventY="-262.5126" EventZ="61.21981"
									MoveOutOfGroundEffectAuraId1="52770"
									MoveAwayFromMobCastingSpellId1="52770"
									MoveAwayFromMobWithAuraId1="52770" >
						<Safespots>
							<Hotspot X="1072.878" Y="-238.3697" Z="61.21747" />
							<Hotspot X="1048.177" Y="-259.9499" Z="61.22632" />
							<Hotspot X="1055.351" Y="-275.9792" Z="61.22632" />
							<Hotspot X="1074.549" Y="-292.4146" Z="61.22632" />
							<Hotspot X="1116.245" Y="-263.2051" Z="56.87384" />
							<Hotspot X="1126.481" Y="-291.871" Z="56.87548" />
							<Hotspot X="1120.172" Y="-244.9818" Z="56.89609" />
						</Safespots>
					</CustomBehavior>
		
								
					<!-- Ionar through The Terrestrial Watchtower -->
					<RunTo X="1072.797" Y="-243.3667" Z="61.22775" />
					<RunTo X="1082.424" Y="-208.6199" Z="61.19545" />
					<RunTo X="1070.009" Y="-208.2739" Z="61.18303" />
					<RunTo X="1088.561" Y="-172.0608" Z="56.64855" />
					<RunTo X="1101.031" Y="-140.362" Z="61.22274" />
					<RunTo X="1062.114" Y="-158.3543" Z="58.29954" />
					<RunTo X="1055.725" Y="-175.954" Z="56.64872" />	
					<RunTo X="1044.641" Y="-144.3857" Z="61.21116" />
					<RunTo X="1049.295" Y="-124.631" Z="61.24968" />
					<RunTo X="1030.777" Y="-111.7629" Z="61.22894" />
					<RunTo X="1073.482" Y="-106.1046" Z="56.74245" />
					<RunTo X="1115.266" Y="-112.6021" Z="61.25701" />
												
					<!-- The Terrestrial Watchtower to safe spot in front of Loken -->
					<RunTo X="1101.464" Y="-101.1851" Z="61.20172" />
					<RunTo X="1081.888" Y="-60.50219" Z="61.2561" />
					<RunTo X="1080.822" Y="-40.98705" Z="61.19673" />
					<RunTo X="1070.298" Y="-19.60738" Z="61.20455" />
					<RunTo X="1034.851" Y="8.42579" Z="61.19508" />
					<RunTo X="1027.746" Y="41.44652" Z="58.34364" />
					<RunTo X="1045.498" Y="73.60362" Z="61.19511" />
					<RunTo X="1077.682" Y="94.48407" Z="61.12906" />
					<RunTo X="1051.499" Y="75.1795" Z="61.19318" />
					<RunTo X="1034.409" Y="58.34495" Z="61.19369" />
					<RunTo X="1034.216" Y="41.24269" Z="58.34371" />
					<RunTo X="1045.779" Y="34.39465" Z="58.34371" />
					<RunTo X="1061.254" Y="50.38601" Z="53.38707" />
					<RunTo X="1083.28" Y="64.37502" Z="53.40649" />
					<RunTo X="1103.162" Y="49.07713" Z="53.39999" />
					<RunTo X="1104.067" Y="20.99123" Z="53.38685" />
					<RunTo X="1089.446" Y="4.553705" Z="53.38301" />
					<RunTo X="1065.083" Y="14.19411" Z="53.37931" />

					<!-- Run to safe spot in front of Loken -->
					<RunTo X="1117.443" Y="34.00689" Z="56.05835" />
					<RunTo X="1157.873" Y="-2.948992" Z="60.54504" />
					
					<!-- Avoid Loken -->
					<CustomBehavior File="MyCTM" X="1175.42" Y="1.121407" Z="60.71124" />
					<CustomBehavior File="MyCTM" X="1210.768" Y="26.30729" Z="60.728" />
										
					<!-- Run to the jump off behind Loken -->			
					<RunTo X="1249.04" Y="33.34788" Z="57.02382" />

					<!-- Jump off -->
					<CustomBehavior File="MyCTM" X="1267.815" Y="33.41695" Z="33.50579" />
					
					<!-- Repair if necessary -->
					<If Condition="(Me.FreeBagSlots &lt;= 15) || (Me.LowestDurabilityPercent &lt;= 0.3)" >
					
						<!-- Profile message - Our durability is less than 30% or our bags are about full. Doing a vendor run -->
						<CustomBehavior File="Message" 
										Text="Our durability is less than 30% or our bags are about full. Doing a vendor run." 
										LogColor="Fuchsia" />
					
						<!-- If our hearthstone is set here, use it -->
						<If Condition="Me.HearthstoneAreaId == 4484">
							<CustomBehavior File="Message" 
											Text="Our Innkeeper is set at Bouldercrag's Refuge." 
											LogColor="Cyan" />
												
							<!-- Have hearthstone -->
							<If Condition="HasItem(6948)">
								<CustomBehavior File="Message" 
												Text="Using Hearthstone." 
												LogColor="Lime" />
												
								<CustomBehavior File="Misc\RunLua" 
												Lua="UseItemByName(6948)" 
												WaitTime="1000" />
												
								<CustomBehavior File="WaitTimer" 
												WaitTime="20000" />
							</If> <!-- Have hearthstone -->
						
							<!-- Have Innkeeper's Daughter -->
							<If Condition="HasItem(64488)">
								<CustomBehavior File="Message" 
												Text="Using Innkeeper's Daughter." 
												LogColor="Lime" />
													
								<CustomBehavior File="Misc\RunLua" 
												Lua="UseItemByName(64488)" 
												WaitTime="1000" />
									
								<CustomBehavior File="WaitTimer" 
												WaitTime="20000" />
							</If> <!-- Have Innkeeper's Daughter -->

							<!-- Halls of Lightning -->
							<If Condition="Me.ZoneId == 4272">
								<CustomBehavior File="Message" 
												Text="Halls of Lightning detected. Running out."
												LogColor="Fuchsia" />
									
								<!-- Make our way to the exit -->
								<RunTo X="1331.41" Y="241.904" Z="52.5046" />

								<!-- Go through the portal -->
								<CustomBehavior File="Misc\InInstance" X="1333.524" Y="290.7161" Z="52.81057" />
								
								<!-- Make sure we run to the right spot outside the potral -->
								<RunTo X="9175.68" Y="-1378.8" Z="1103.57" />
							</If> <!-- HoL -->
							
							<CustomBehavior File="ForceSetVendor" 
											DoMail="True" 
											DoRepair="True" 
											DoSell="True" 
											DoTrain="False" />
							
							<SetVendor>
								<Vendors>
									<!-- Bouldercrag's Refuge -->
									<Vendor Name="Dargum Hammerdeep" 
											Entry="29964"
											Type="Repair"
											X="8383.45" Y="-390.166" Z="903.1188" />
								</Vendors>
							</SetVendor>
						
							<SetMailbox>
								<Mailboxes>
									<Mailbox X="8443.896" Y="-329.4509" Z="906.608" />
								</Mailboxes>
							</SetMailbox>
						
							<!-- We are done repairing -->
							<If Condition="(Me.FreeBagSlots &gt; 15) &amp;&amp; (Me.LowestDurabilityPercent &gt; 0.3)" >
								<CustomBehavior File="Message" 
												Text="Repairing complete." 
												LogColor="Fuchsia" />
												
							</If> <!-- repaired -->
							
							<!-- Fly to the hover point above the innkeep in Bouldercrag's Refuge -->
							<CustomBehavior File="FlyTo" X="8471.806" Y="-301.3479" Z="976.4656" />
								
							<CustomBehavior File="Message" 
							Text="Flying to Halls of Lighning." 
							LogColor="Lime" />
								
							<!--CTM's to Halls of Lightning -->
							<CustomBehavior File="MyCTM" X="8550.668" Y="-434.3782" Z="1106.936" />
							<CustomBehavior File="MyCTM" X="8833.596" Y="-1091.447" Z="1229.66" />	
							<CustomBehavior File="MyCTM" X="9035.232" Y="-1264.308" Z="1227.567" />
	
							<!-- Instance timer check if we did repair-->
							<CustomBehavior File="Misc\InstanceTimer" Timer="Check" />
										
							<!-- Fly down -->
							<CustomBehavior File="MyCTM" X="9175.68" Y="-1378.8" Z="1103.57" />
							<CustomBehavior File="ForcedDismount" />
							
							<RunTo X="9175.68" Y="-1378.8" Z="1103.57" />
							
						</If>	<!-- If our hearthstone is set here, use it -->
					</If> <!-- Repair if necessary -->
				</If> <!-- HoL -->
				
				<!-- Halls of Lightning -->
				<If Condition="Me.ZoneId == 4272">
					<CustomBehavior File="Message" 
									Text="Halls of Lightning detected. Running out to reset."
									LogColor="Fuchsia" />
						
					<!-- Make our way to the exit -->
					<RunTo X="1331.41" Y="241.904" Z="52.5046" />

					<!-- If we are high enough to go to the next instance, do so -->
					<CustomBehavior File="Misc\LoadProfileOn" 
									MinLevel="87" 
									ProfileName="[QO-N][Solstice][87-88]_blackrock-caverns.xml"  />
					
					<!-- Instance timer check if we did repair-->
					<CustomBehavior File="Misc\InstanceTimer" Timer="Check" />
						
					<!-- Go through the portal -->
					<CustomBehavior File="Misc\InInstance" X="1333.524" Y="290.7161" Z="52.81057" />
					
					<!-- Make sure we run to the right spot outside the potral -->
					<RunTo X="9175.68" Y="-1378.8" Z="1103.57" />
				</If> <!-- HoL -->
			</While> <!-- Infinite loop -->
		</If> <!-- Booster -->	
		
		
	</QuestOrder>
</HBProfile>